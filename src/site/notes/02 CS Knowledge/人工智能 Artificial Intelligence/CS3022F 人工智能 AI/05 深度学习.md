---
{"dg-publish":true,"permalink":"/02 CS Knowledge/äººå·¥æ™ºèƒ½ Artificial Intelligence/CS3022F äººå·¥æ™ºèƒ½ AI/05 æ·±åº¦å­¦ä¹ /","dgPassFrontmatter":true,"noteIcon":""}
---

## 01 å‰é¦ˆç¥ç»ç½‘ç»œ

### åŸºæœ¬æ¦‚å¿µ

ç¥ç»å…ƒæ˜¯æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­åŸºæœ¬å•ä½ã€‚å¯ä»¥å¦‚ä¸‹åˆ»ç”»ç¥ç»å…ƒåŠŸèƒ½ï¼š
1. å¯¹ç›¸é‚»å‰å‘ç¥ç»å…ƒè¾“å…¥ä¿¡æ¯è¿›è¡ŒåŠ æƒç´¯åŠ ï¼š$In=\sum_i^n=w_i*a_i$
2. å¯¹ç´¯åŠ ç»“æœè¿›è¡Œéçº¿æ€§å˜æ¢ (é€šè¿‡æ¿€æ´»å‡½æ•°) $:g(x)$
3. ç¥ç»å…ƒçš„è¾“å‡ºï¼šOut $=g(In)$

![Pasted image 20250422095711.png|375](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422095711.png)

ç¥ç»ç½‘ç»œä½¿ç”¨éçº¿æ€§å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼ˆactivation functionï¼‰ï¼Œé€šè¿‡å¯¹å¤šä¸ªéçº¿æ€§å‡½æ•°è¿›è¡Œç»„åˆï¼Œæ¥å®ç°å¯¹è¾“å…¥ä¿¡æ¯çš„éçº¿æ€§å˜æ¢ï¼š
![Pasted image 20250422095734.png|375](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422095734.png)

Softmax å‡½æ•°ä¸€èˆ¬ç”¨äºå¤šåˆ†ç±»é—®é¢˜ä¸­ï¼Œå…¶å°†è¾“å…¥æ•°æ® $x_i$ æ˜ å°„åˆ°ç¬¬ $i$ ä¸ªç±»åˆ«çš„æ¦‚ç‡ $y_i$ å¦‚ä¸‹è®¡ç®—ï¼š
$$y_i=\mathrm{softmax}(x_i)=\frac{e^{x_i}}{\sum_{j=1}^ke^{x_j}}$$
![Pasted image 20250422095830.png|250](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422095830.png)

å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆfeedforward neural networkï¼‰
- å„ä¸ªç¥ç»å…ƒæ¥å—å‰ä¸€çº§çš„è¾“å…¥ï¼Œå¹¶è¾“å‡ºåˆ°ä¸‹ä¸€çº§ï¼Œæ¨¡å‹ä¸­æ²¡æœ‰åé¦ˆ
- å±‚ä¸å±‚ä¹‹é—´é€šè¿‡â€œå…¨è¿æ¥â€è¿›è¡Œé“¾æ¥ï¼Œå³ä¸¤ä¸ªç›¸é‚»å±‚ä¹‹é—´çš„ç¥ç»å…ƒå®Œå…¨æˆå¯¹è¿æ¥ï¼Œä½†å±‚å†…çš„ç¥ç»å…ƒä¸ç›¸äº’è¿æ¥

æŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰ï¼šè®¡ç®—æ¨¡å‹é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®
- å‡æ–¹è¯¯å·®æŸå¤±å‡½æ•°ï¼šè®¡ç®—é¢„æµ‹å€¼å’Œå®é™…å€¼ä¹‹é—´è·ç¦»ï¼ˆå³è¯¯å·®ï¼‰çš„å¹³æ–¹æ¥è¡¡é‡æ¨¡å‹ä¼˜åŠ£
	$$\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2$$
- äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼šåº¦é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒé—´çš„å·®å¼‚
	$$H(p,q)=-\sum_{x}p(x)*logq(x)$$
	äº¤å‰ç†µè¶Šå°ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒ p å’Œ q è¶Šæ¥è¿‘
	Softmax å’Œäº¤å‰ç†µæŸå¤±å‡½æ•°ç›¸äº’ç»“åˆï¼Œä¸ºåå¯¼è®¡ç®—å¸¦æ¥äº†æå¤§ä¾¿åˆ© Softmax with cross-entropy loss

### æ„ŸçŸ¥æœºæ¨¡å‹

æ—©æœŸçš„æ„ŸçŸ¥æœºç»“æ„å’Œ MCP æ¨¡å‹ç›¸ä¼¼ï¼Œç”±ä¸€ä¸ªè¾“å…¥å±‚å’Œä¸€ä¸ªè¾“å‡ºå±‚æ„æˆï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸º â€œå•å±‚æ„ŸçŸ¥æœºâ€ã€‚æ„ŸçŸ¥æœºçš„è¾“å…¥å±‚è´Ÿè´£æ¥æ”¶å®æ•°å€¼çš„è¾“å…¥å‘é‡ï¼Œè¾“å‡ºå±‚åˆ™èƒ½è¾“å‡º 1 æˆ– -1 ä¸¤ä¸ªå€¼
![Pasted image 20250530144957.png|400](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530144957.png)

å¤šå±‚æ„ŸçŸ¥æœºç”±è¾“å…¥å±‚ã€è¾“å‡ºå±‚å’Œè‡³å°‘ä¸€å±‚çš„éšè—å±‚æ„æˆ
- ç½‘ç»œä¸­å„ä¸ªéšè—å±‚ä¸­ç¥ç»å…ƒå¯æ¥æ”¶ç›¸é‚»å‰åºéšè—å±‚ä¸­æ‰€æœ‰ç¥ç»å…ƒä¼ é€’è€Œæ¥çš„ä¿¡æ¯ï¼Œç»è¿‡åŠ å·¥å¤„ç†åå°†ä¿¡æ¯è¾“å‡ºç»™ç›¸é‚»åç»­éšè—å±‚ä¸­æ‰€æœ‰ç¥ç»å…ƒã€‚
- å„ä¸ªç¥ç»å…ƒæ¥å—å‰ä¸€çº§çš„è¾“å…¥ï¼Œå¹¶è¾“å‡ºåˆ°ä¸‹ä¸€çº§ï¼Œæ¨¡å‹ä¸­æ²¡æœ‰åé¦ˆ 
- å±‚ä¸å±‚ä¹‹é—´é€šè¿‡â€œå…¨è¿æ¥â€è¿›è¡Œé“¾æ¥ï¼Œå³ä¸¤ä¸ªç›¸é‚»å±‚ä¹‹é—´çš„ç¥ç»å…ƒå®Œå…¨æˆå¯¹è¿æ¥ï¼Œä½†å±‚å†…çš„ç¥ç»å…ƒä¸ç›¸äº’è¿æ¥
- ä¹Ÿå°±æ˜¯å‰é¦ˆç¥ç»ç½‘ç»œ feedforward neural network
![Pasted image 20250530145120.png|475](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530145120.png)

### å¦‚ä½•ä¼˜åŒ–ç½‘ç»œå‚æ•°ï¼Ÿ

ä»æ ‡æ³¨æ•°æ®å‡ºå‘ï¼Œä¼˜åŒ–æ¨¡å‹å‚æ•°
- æ ‡æ³¨æ•°æ®ï¼š$(x_i,y_i)(1\leq i\leq N)$
- è¯„åˆ†å‡½æ•° (scoring function) å°†è¾“å…¥æ•°æ®æ˜ å°„ä¸ºç±»åˆ«ç½®ä¿¡åº¦å¤§|å°ï¼šs $=f(x)=W\varphi(x)$
- æŸå¤±å‡½æ•°æ¥ä¼°é‡æ¨¡å‹é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´çš„å·®è·ã€‚æŸå¤±å‡½æ•°ç»™å‡ºçš„å·®è·è¶Šå°ï¼Œåˆ™æ¨¡å‹é²æ£’æ€§å°±è¶Šå¥½ã€‚|å¸¸ç”¨çš„æŸå¤±å‡½æ•°æœ‰ softmax æˆ–è€… SVM
![Pasted image 20250530150821.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530150821.png)

#### æ¢¯åº¦ä¸‹é™ Gradient Descent

æ¢¯åº¦ä¸‹é™ç®—æ³•æ˜¯ä¸€ç§ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°åŒ–çš„æ–¹æ³•ã€‚ä¸€å…ƒå˜é‡æ‰€æ„æˆå‡½æ•°ğ’‡åœ¨ğ’™å¤„æ¢¯åº¦ä¸ºï¼š
$$\frac{df(x)}{dx} = \lim_{h \to 0} \frac{f(x + h) - f(x)}{h}$$
- åœ¨å¤šå…ƒå‡½æ•°ä¸­ï¼Œæ¢¯åº¦æ˜¯å¯¹æ¯ä¸€å˜é‡æ‰€æ±‚å¯¼æ•°ç»„æˆçš„å‘é‡
	$$\nabla f(\mathbf{x})=\begin{bmatrix}\frac{\partial f(\mathbf{x})}{\partial x_1}\\\frac{\partial f(\mathbf{x})}{\partial x_2}\\\vdots\\\frac{\partial f(\mathbf{x})}{\partial x_n}\end{bmatrix}$$
- æ¢¯åº¦çš„åæ–¹å‘æ˜¯å‡½æ•°å€¼ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼Œå› æ­¤æ˜¯æŸå¤±å‡½æ•°æ±‚è§£çš„æ–¹å‘

å‡è®¾æŸå¤±å‡½æ•° $f(x)$ æ˜¯è¿ç»­å¯å¾®çš„å¤šå…ƒå˜é‡å‡½æ•°, å…¶æ³°å‹’å±•å¼€å¦‚ä¸‹ ( $\Delta x$ æ˜¯å¾®å°çš„å¢é‡):
$$f(x+\Delta x)=f(x)+f'(x)\Delta x+\frac{1}{2}f''(x)(\Delta x)^2+\cdots+\frac{1}{n!}f^{(n)}(x) (\Delta x)^n$$
$$
f(x+\Delta x)-f(x)\approx(\nabla f(x))^T\Delta x$$
- ä¸ºäº†ä¿è¯ $(\nabla f(\mathbf{x}))^T\Delta\mathbf{x}<0$, æˆ‘ä»¬é€‰æ‹©è®© $\Delta\mathbf{x}$ ä¸æ¢¯åº¦ $\nabla f(\mathbf{x})$ çš„æ–¹å‘ç›¸åã€‚æœ€ç®€å•çš„é€‰æ‹©æ˜¯è®©
$\Delta\mathbf{x}$ æ­£æ¯”äºæ¢¯åº¦çš„è´Ÿæ–¹å‘ï¼š
	$$\Delta\mathbf{x}=-\eta\nabla f(\mathbf{x})$$
- å…¶ä¸­ï¼Œ$\eta$ æ˜¯ä¸€ä¸ªæ­£çš„å¸¸æ•°ï¼Œç§°ä¸ºå­¦ä¹ ç‡ (learning rate) æˆ–æ­¥é•¿ (step size)ã€‚å­¦ä¹ ç‡æ§åˆ¶ç€æ¯æ¬¡è¿­ä»£ä¸­å‚æ•°æ›´æ–°çš„å¹…åº¦ã€‚
- å°† $\Delta\mathbf{x}$ ä»£å…¥ $\mathbf{x}+\Delta\mathbf{x}$, å¾—åˆ°å‚æ•°çš„æ›´æ–°å…¬å¼ï¼š
	$$\mathbf{x}_{new}=\mathbf{x}_{old}-\eta\nabla f(\mathbf{x}_{old})$$
- è¿™ä¸ªå…¬å¼è¡¨ç¤ºåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬éƒ½æ²¿ç€å½“å‰ç‚¹ $\mathbf{x}_{old}$ å¤„æ¢¯åº¦ $\nabla f(\mathbf{x}_{old})$ çš„åæ–¹å‘ç§»åŠ¨ä¸€å°æ­¥ (æ­¥é•¿ä¸º $\eta$), ä»è€Œæ›´æ–°å‚æ•°åˆ° $\mathbf{x}_{new}$, å¸Œæœ›èƒ½å¤Ÿé€æ­¥æ¥è¿‘æŸå¤±å‡½æ•°çš„æœ€å°å€¼

#### è¯¯å·®åå‘ä¼ æ’­ Error Back Propagation (BP)

BP ç®—æ³•æ˜¯ä¸€ç§å°†è¾“å‡ºå±‚è¯¯å·®åå‘ä¼ æ’­ç»™éšè—å±‚è¿›è¡Œå‚æ•°æ›´æ–°çš„æ–¹æ³•

![Pasted image 20250530152625.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152625.png)

> [!note]- å‰å‘ä¼ æ’­
> 
> ![Pasted image 20250530152657.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152657.png)
> ![Pasted image 20250530152702.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152702.png)
> ![Pasted image 20250530152710.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152710.png)
> ![Pasted image 20250530152716.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152716.png)
> ![Pasted image 20250530152723.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152723.png)

> [!note]- åå‘ä¼ æ’­-æ¢¯åº¦ä¸‹é™
> 
> ![Pasted image 20250530152808.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152808.png)
> ![Pasted image 20250530152823.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152823.png)
> ![Pasted image 20250530152847.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530152847.png)

#### æ¢¯åº¦ä¸‹é™ç®—æ³•

- æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆBatch Gradient Descent, BGDï¼‰ 
	- ä¸€æ¬¡è¿­ä»£å¯¹æ‰€æœ‰æ ·æœ¬è¿›è¡Œè®¡ç®—ï¼Œåˆ©ç”¨çŸ©é˜µè¿›è¡Œæ“ä½œå¯å®ç°å¹¶è¡Œ
	- å½“ç›®æ ‡å‡½æ•°ä¸ºå‡¸å‡½æ•°æ—¶ï¼ŒBGD ä¸€å®šèƒ½å¤Ÿå¾—åˆ°å…¨å±€æœ€ä¼˜
	- å½“æ ·æœ¬æ•°ç›®å¾ˆå¤§æ—¶ï¼Œæ¯è¿­ä»£ä¸€æ­¥éƒ½éœ€è¦å¯¹æ‰€æœ‰æ ·æœ¬è®¡ç®—ï¼Œè®­ç»ƒè¿‡ç¨‹ä¼šå¾ˆæ…¢
- éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descentï¼ŒSGDï¼‰ 
	- åœ¨æ¯è½®è¿­ä»£ä¸­ï¼Œéšæœºä¼˜åŒ–ä¸€ä¸ªæ ·æœ¬çš„æŸå¤±ï¼Œæ¯ä¸€è½®å‚æ•°çš„æ›´æ–°é€Ÿåº¦å¤§å¤§åŠ å¿«
	- å‡†ç¡®åº¦ä¸‹é™ã€‚å³ä½¿ç›®æ ‡å‡½æ•°ä¸ºå¼ºå‡¸å‡½æ•°ï¼ŒSGD ä»æ— æ³•çº¿æ€§æ”¶æ•›
	- å¯èƒ½ä¼šæ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜ï¼Œç”±äºå•ä¸ªæ ·æœ¬ä¸èƒ½ä»£è¡¨å…¨ä½“æ ·æœ¬è¶‹åŠ¿
	- ä¸æ˜“äºå®ç°å¹¶è¡Œ
- å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆMini-Batch Gradient Descent, MBGDï¼‰
	- æ¯æ¬¡è¿­ä»£ä½¿ç”¨ **batch_size** ä¸ªæ ·æœ¬æ¥å¯¹å‚æ•°è¿›è¡Œæ›´æ–°

> [!NOTE] batch size çš„é€‰æ‹©å¸¦æ¥çš„å½±å“
> 
> åœ¨åˆç†åœ°èŒƒå›´å†…ï¼Œå¢å¤§ batch size çš„å¥½å¤„ï¼š
> - å†…å­˜åˆ©ç”¨ç‡æé«˜äº†
> - è·‘å®Œä¸€æ¬¡ epoch (å…¨æ•°æ®é›†) æ‰€éœ€çš„è¿­ä»£æ¬¡æ•°å‡å°‘
> - åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œä¸€èˆ¬æ¥è¯´ Batch\_Size è¶Šå¤§ï¼Œå…¶ç¡®å®šçš„ä¸‹é™æ–¹å‘è¶Šå‡†ï¼Œå¼•èµ·è®­ç»ƒéœ‡è¡è¶Šå°
> 
> ç›²ç›®å¢å¤§ batch\_size çš„åå¤„ï¼š
> - å†…å­˜å®¹é‡å¯èƒ½æ’‘ä¸ä½äº†
> - è·‘å®Œä¸€æ¬¡ epoch (å…¨æ•°æ®é›†) æ‰€éœ€çš„è¿­ä»£æ¬¡æ•°å‡å°‘ï¼Œä½†è¦æƒ³è¾¾åˆ°ç›¸åŒçš„ç²¾åº¦ï¼Œå…¶æ‰€èŠ±è´¹çš„æ—¶é—´å¤§å¤§å¢åŠ äº†ï¼Œä»è€Œå¯¹å‚æ•°çš„ä¿®æ­£ä¹Ÿå°±æ˜¾å¾—æ›´åŠ ç¼“æ…¢
> - Batch Size å¢å¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œå…¶ç¡®å®šçš„ä¸‹é™æ–¹å‘å·²ç»åŸºæœ¬ä¸å†å˜åŒ–


---
## 02 å·ç§¯ç¥ç»ç½‘ç»œ CNN

ä¸ºä»€ä¹ˆéœ€è¦å·ç§¯ç¥ç»ç½‘ç»œğŸ‘‡
å½“æ¨¡å‹å‚æ•°æ•°é‡å˜å¾—å·¨å¤§æ—¶ï¼Œä¸ä»…ä¼šå ç”¨å¤§é‡è®¡ç®—æœºå†…å­˜ï¼ŒåŒæ—¶ä¹Ÿä½¿ç¥ç»ç½‘ç»œæ¨¡å‹å˜å¾—éš¾ä»¥è®­ç»ƒæ”¶æ•›ã€‚å› æ­¤ï¼Œå¯¹äºå›¾åƒè¿™æ ·çš„æ•°æ®ï¼Œä¸èƒ½ç›´æ¥å°†æ‰€æ„æˆçš„åƒç´ ç‚¹å‘é‡ä¸å‰é¦ˆç¥ç»ç½‘ç»œç¥ç»å…ƒç›¸è¿ã€‚

### 2.1 å·ç§¯

- å·ç§¯ï¼ˆconvolutionï¼‰ï¼šå°±æ˜¯é’ˆå¯¹åƒç´ ç‚¹çš„ç©ºé—´ä¾èµ–æ€§æ¥å¯¹å›¾åƒè¿›è¡Œå¤„ç†çš„ä¸€ç§æŠ€æœ¯
- å·ç§¯æ ¸ï¼ˆkernelï¼‰ï¼šä¸€ä¸ªäºŒç»´çŸ©é˜µ (å¯ä»¥æ˜¯å¤šç»´çš„ï¼Œä¾‹å¦‚ RGB å›¾åƒï¼Œæœ‰ä¸‰ç»´çš„å·ç§¯æ ¸ï¼Œåˆ†åˆ«é’ˆå¯¹ä¸‰ä¸ªé€šé“è¿›è¡Œ convolution)
	- æƒé‡ï¼šé€šè¿‡æ•°æ®é©±åŠ¨æœºåˆ¶å­¦ä¹ å¾—åˆ°ï¼Œæ•æ‰å›¾åƒç©ºé—´ç‰¹å¾
- å·ç§¯æ“ä½œï¼š
	- æ­¥é•¿ Strideï¼šæ¯è¿›è¡Œä¸€æ¬¡å·ç§¯è®¡ç®—åï¼Œå·ç§¯æ ¸ç§»åŠ¨çš„æ ¼æ•°
- æ„Ÿå—é‡ï¼ˆreceptive fieldï¼‰ï¼šæ„Ÿå—é‡æ˜¯ç‰¹å¾å›¾ä¸Šä¸€ä¸ªç‚¹å¯¹åº”è¾“å…¥å›¾åƒä¸Šçš„åŒºåŸŸ


ä¸åŒå·ç§¯æ ¸å¯è¢«ç”¨æ¥åˆ»ç”»è§†è§‰ç¥ç»ç»†èƒå¯¹å¤–ç•Œä¿¡æ¯æ„Ÿå—æ—¶çš„ä¸åŒé€‰æ‹©æ€§ï¼š
![Pasted image 20250422103311.png|475](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422103311.png)


### 2.2 æ± åŒ–

å›¾åƒä¸­å­˜åœ¨è¾ƒå¤šå†—ä½™ï¼Œå¯ç”¨æŸä¸€åŒºåŸŸå­å—çš„ç»Ÿè®¡ä¿¡æ¯ ï¼ˆå¦‚æœ€å¤§å€¼æˆ–å‡å€¼ç­‰ï¼‰æ¥åˆ»ç”»è¯¥åŒºåŸŸä¸­æ‰€æœ‰åƒç´ ç‚¹å‘ˆç°çš„ç©ºé—´åˆ†å¸ƒæ¨¡å¼

æ± åŒ– Pooling: å¯¹è¾“å…¥çš„ç‰¹å¾å›¾è¿›è¡Œä¸‹é‡‡æ ·ï¼Œä»¥è·å¾—æœ€ä¸»è¦çš„ä¿¡æ¯
- Max Pooling
- Mean Pooling
- Stochastic Pooling (å¯¹åƒç´ ç‚¹æŒ‰ç…§æ•°å€¼å¤§å°èµ‹äºˆæ¦‚ç‡)
![Pasted image 20250422103948.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422103948.png)



åˆ†å¸ƒå¼å‘é‡è¡¨è¾¾ (distributed vector representation)ï¼šå·ç§¯ç¥ç»ç½‘ç»œåœ¨è‹¥å¹²æ¬¡å·ç§¯æ“ä½œã€æ¥ç€å¯¹å·ç§¯æ‰€å¾—ç»“æœè¿›è¡Œæ¿€æ´»å‡½æ•°æ“ä½œå’Œæ± åŒ–æ“ä½œä¸‹ï¼Œæœ€åé€šè¿‡å…¨è¿æ¥å±‚æ¥å­¦ä¹ å¾—åˆ°è¾“å…¥æ•°æ®çš„ç‰¹å¾è¡¨è¾¾
- å·ç§¯å±‚ï¼šæå–å±€éƒ¨ç‰¹å¾
- æ± åŒ–å±‚ï¼šé™ç»´
- æ¿€æ´»å‡½æ•°ï¼šéçº¿æ€§åŒ–
- å…¨è¿æ¥å±‚ï¼šç”¨äºè¾“å‡ºæƒ³è¦çš„ç»“æœ (ä¸‹æ¸¸ä»»åŠ¡)
![Pasted image 20250422104649.png|425](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422104649.png)

### 2.3 æ­£åˆ™åŒ–

æ­£åˆ™åŒ–ç³»æ•° ğŸ‘‰ ç¼“è§£ç¥ç»ç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°çš„è¿‡æ‹Ÿåˆé—®é¢˜

æœ‰å¦‚ä¸‹å‡ ç§æ–¹æ³•ï¼š
- Dropout
	æ¯æ¬¡å‚æ•°æ›´æ–°æ—¶éšæœºä¸¢æ‰ä¸€éƒ¨åˆ†ç¥ç»å…ƒæ¥å‡å°‘ç¥ç»ç½‘ç»œå¤æ‚åº¦ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆ
- Batch-Normalizationï¼ˆæ‰¹å½’ä¸€åŒ–ï¼‰
	é€šè¿‡è§„èŒƒåŒ–çš„æ‰‹æ®µï¼ŒæŠŠç¥ç»ç½‘ç»œæ¯å±‚ä¸­ä»»æ„ç¥ç»å…ƒçš„è¾“å…¥å€¼åˆ†å¸ƒæ”¹å˜åˆ°å‡å€¼ä¸º 0ã€æ–¹å·®ä¸º 1 çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒ
- L1-Norm & L2-Norm
	$L_1$ èŒƒæ•°ï¼šæ•°å­¦è¡¨ç¤ºä¸º $\|W\|_1=\Sigma_{i=1}^\mathbb{N}|w_i|$, æŒ‡æ¨¡å‹å‚æ•° $W$ ä¸­å„ä¸ªå…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œ
	$L_1$ èŒƒæ•°ä¹Ÿè¢«ç§°ä¸º â€œç¨€ç–è§„åˆ™ç®—å­â€ ( Lasso regularization)  
	$L_2$ èŒƒæ•°ï¼šæ•°å­¦è¡¨ç¤ºä¸º $\|W\|_2=\sqrt{\Sigma_{i=1}^\mathbb{N}w_i^2}$, æŒ‡æ¨¡å‹å‚æ•° $W$ ä¸­å„ä¸ªå…ƒç´ å¹³æ–¹å’Œçš„å¼€æ–¹
	$Loss=åŸå§‹æŸå¤±+\lambdaÃ—æ­£åˆ™é¡¹$
	"ç»“æ„é£é™©æœ€å°åŒ–"

### 2.4 AlexNet

> [!warning] è€ƒè¯•ä¸ä½œè¦æ±‚

![Pasted image 20250422111145.png|400](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422111145.png)

- å½“å»æ‰çš„å±‚æ•°è¿‡å¤šæ—¶ï¼Œæ€§èƒ½ä¼šå‘ç”Ÿæ˜æ˜¾çš„ä¸‹é™
![Pasted image 20250422111116.png|400](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422111116.png)


---
## 03 å¾ªç¯ç¥ç»ç½‘ç»œ RNN

å¾ªç¯ç¥ç»ç½‘ç»œï¼šä¸€ç±»å¤„ç†åºåˆ—æ•°æ®ï¼ˆå¦‚æ–‡æœ¬å¥å­ã€è§†é¢‘å¸§ç­‰ï¼‰æ—¶æ‰€é‡‡ç”¨çš„ç½‘ç»œç»“æ„
- æœ¬è´¨æ˜¯å¸Œæœ›æ¨¡æ‹Ÿäººæ‰€å…·æœ‰çš„è®°å¿†èƒ½åŠ›ï¼Œåœ¨å­¦ä¹ è¿‡ç¨‹ä¸­è®°ä½éƒ¨åˆ†å·²ç»å‡ºç°çš„ä¿¡æ¯ï¼Œå¹¶åˆ©ç”¨æ‰€è®°ä½çš„ä¿¡æ¯å½±å“åç»­ç»“ç‚¹è¾“å‡º

### 3.1 åŸºæœ¬æ¶æ„

åœ¨æ—¶åˆ» $t$, ä¸€æ—¦å¾—åˆ°å½“å‰è¾“å…¥æ•°æ® $x_t$, å¾ªç¯ç¥ç»ç½‘ç»œä¼šç»“åˆå‰ä¸€æ—¶åˆ» $t-1$ å¾—åˆ°çš„éšå¼ç¼–ç  $h_{t-1}$, å¦‚ä¸‹äº§ç”Ÿå½“å‰æ—¶åˆ»éšå¼ç¼–ç  $h_t:$
	$$h_t=\Phi(\mathrm{U}\times x_t+\mathrm{W}\times h_{t-1})$$
- è¿™é‡Œ $\Phi(\cdot)$ æ˜¯æ¿€æ´»å‡½æ•°ï¼Œä¸€èˆ¬å¯ä¸º Sigmoid æˆ–è€… Tanh æ¿€æ´»å‡½æ•°ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿå¿˜æ‰æ— å…³çš„ä¿¡æ¯ï¼ŒåŒæ—¶æ›´æ–°è®°å¿†å†…å®¹ã€‚U ä¸ W ä¸ºæ¨¡å‹å‚æ•°

![Pasted image 20250422112301.png|400](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422112301.png)

å¾ªç¯ç¥ç»ç½‘ç»œè¯»å…¥æ¯ä¸ªå•è¯åï¼Œå…ˆäº§ç”Ÿå¯¹åº”å•è¯çš„éšå¼ç¼–ç ï¼Œå†å¦‚ä¸‹å¾—åˆ°ä¸€ä¸ªå¥å­çš„å‘é‡ç¼–ç ï¼š
1. æœ€åä¸€ä¸ªå•è¯è¾“å‡ºä½œä¸ºæ•´ä¸ªå¥å­çš„ç¼–ç 
	- å› ä¸ºå¥å­ä¸­æ‰€æœ‰å•è¯çš„ä¿¡æ¯å‡è¢«åå‘ä¼ é€’
2. å°†æ¯ä¸ªå•è¯çš„éšå¼ç¼–ç è¿›è¡ŒåŠ æƒå¹³å‡ï¼Œå°†åŠ æƒå¹³å‡ç»“æœä½œä¸ºæ•´ä¸ªå¥å­çš„å‘é‡ç¼–ç è¡¨ç¤º
![Pasted image 20250607204644.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250607204644.png)


### 3.2 æ¢¯åº¦ä¼ é€’

- æ—¶åˆ» $t$ è¾“å…¥æ•°æ® $x_t$ (æ–‡æœ¬ä¸­çš„å•è¯) çš„éšå¼ç¼–ç ä¸º $h_t$ã€å…¶çœŸå®è¾“å‡ºä¸º $y_t$ (å•è¯è¯æ€§)ã€æ¨¡å‹é¢„æµ‹ $x_t$ çš„è¯æ€§æ˜¯ $O_t$
- å‚æ•° $W_x$ å°† $x_t$ æ˜ å°„ä¸ºéšå¼ç¼–ç  $h_t$ã€å‚æ•° $W_o$ å°† $h_t$ æ˜ å°„ä¸ºé¢„æµ‹è¾“å‡º $O_t$ã€$h_{t-1}$ é€šè¿‡å‚æ•° $W_h$ å‚ä¸ $h_t$ çš„ç”Ÿæˆã€‚
- å›¾ä¸­ $W_x$ã€$W_o$ å’Œ $W_h$ æ˜¯å¤ç”¨å‚æ•°
![Pasted image 20250422113534.png](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422113534.png)


### 3.3 åŸºæœ¬ç»“æ„

ä¸€äº›åŸºæœ¬çš„ RNN ç»“æ„ï¼š
- å¤šå¯¹å¤š ğŸ‘‰ æœºå™¨ç¿»è¯‘
- å¤šå¯¹ä¸€ ğŸ‘‰ æƒ…æ„Ÿåˆ†ç±»
- ä¸€å¯¹å¤š ğŸ‘‰ å›¾åƒæè¿°ç”Ÿæˆ
![Pasted image 20250422114342.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422114342.png)

åŒå‘å¾ªç¯ç¥ç»ç½‘ç»œï¼š
e.g. æˆ‘çš„æ‰‹æœºåäº†ï¼Œæˆ‘æ‰“ç®—\_\_\_\_ä¸€éƒ¨æ–°æ‰‹æœº

![Pasted image 20250422114741.png|400](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422114741.png)

å †å ï¼ˆå¤šå±‚ï¼‰å¾ªç¯ç¥ç»ç½‘ç»œï¼š
![Pasted image 20250607205152.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250607205152.png)




### 3.4 LSTM

ç”±äº tanh å‡½æ•°çš„å¯¼æ•°å–å€¼ä½äº 0 åˆ° 1 åŒºé—´ï¼Œå¯¹äºé•¿åºåˆ—è€Œè¨€ï¼Œè‹¥å¹²å¤šä¸ª 0 åˆ° 1 åŒºé—´çš„å°æ•°ç›¸ä¹˜ï¼Œä¼šä½¿å¾—å‚æ•°æ±‚å¯¼ç»“æœå¾ˆå°ï¼Œå¼•å‘æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œé•¿çŸ­æ—¶è®°å¿†æ¨¡å‹ï¼ˆLongShort-Term Memoryï¼ŒLSTMï¼‰è¢«æå‡º


![Pasted image 20250422115238.png|475](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422115238.png)

| ç¬¦å·      | å†…å®¹æè¿°/æ“ä½œ                                                                                                                                                                                              |
| ------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| $x_t$   | æ—¶åˆ» t è¾“å…¥çš„æ•°æ®                                                                                                                                                                                           |
| $i_t$   | è¾“å…¥é—¨çš„è¾“å‡º: $i_t = sigmoid (W_{xi}x_t + W_{hi}h_{t-1} + b_i)$<br>( $W_{xi}$ ã€ $W_{hi}$ å’Œ $b_i$ ä¸ºè¾“å…¥é—¨çš„å‚æ•°)<br>**è¾“å…¥é—¨ $i_t$ æ§åˆ¶æœ‰å¤šå°‘ä¿¡æ¯æµå…¥å½“å‰æ—¶åˆ»å†…éƒ¨è®°å¿†å•å…ƒ $c_t$**                                                       |
| $f_t$   | é—å¿˜é—¨çš„è¾“å‡º: $f_t = sigmoid (W_{xf}x_t + W_{hf}h_{t-1} + b_f)$<br>( $W_{xf}$ ã€ $W_{hf}$ å’Œ $b_f$ ä¸ºé—å¿˜é—¨çš„å‚æ•°)<br>**é—å¿˜é—¨æ§åˆ¶ä¸Šä¸€æ—¶åˆ»å†…éƒ¨è®°å¿†å•å…ƒ $c_{t-1}$ ä¸­æœ‰å¤šå°‘ä¿¡æ¯å¯ç´¯ç§¯åˆ°å½“å‰æ—¶åˆ»å†…éƒ¨è®°å¿†å•å…ƒ $c_t$**                                      |
| $o_t$   | è¾“å‡ºé—¨çš„è¾“å‡º: $o_t = sigmoid (W_{xo}x_t + W_{ho}h_{t-1} + b_o)$<br>( $W_{xo}$ ã€ $W_{ho}$ å’Œ $b_o$ ä¸ºè¾“å‡ºé—¨çš„å‚æ•°)<br>**è¾“å‡ºé—¨æ§åˆ¶ $c_t$ æœ€ç»ˆå‘ $h_t$ çš„è¾“å‡ºæƒ…å†µ**                                                               |
| $c_t$   | å†…éƒ¨è®°å¿†å•å…ƒçš„è¾“å‡ºï¼š$c_t={f_t}\odot c_{t-1}+{i_t}\odot tanh (W_{xc}{x_t}+W_{hc}{h_{t-1}}+b_c)$<br>$(W_{xc}$ã€$W_{hc}$ å’Œ $b_c$ ä¸ºè®°å¿†å•å…ƒçš„å‚æ•°ï¼‰                                                                         |
| $h_t$   | æ—¶åˆ» $t$ è¾“å…¥æ•°æ®çš„éšå¼ç¼–ç ï¼š<br>$$h_{t}=o_{t}\odot\tanh (c_{t})=o_{t}\odot\tanh (f_{t}\odot c_{t-1}+i_{t}\odot\tanh (W_{xc}x_{t}+W_{hc}h_{t-1}+b_{c}))$$<br>**(è¾“å…¥é—¨ã€é—å¿˜é—¨å’Œè¾“å‡ºé—¨çš„ä¿¡æ¯ $i_t$ã€$f_t$ã€$o_t$ ä¸€èµ·å‚ä¸å¾—åˆ° $h_t$ï¼‰** |
| $\odot$ | ä¸¤ä¸ªå‘é‡ä¸­å¯¹åº”å…ƒç´ æŒ‰ä½ç›¸ä¹˜ (element-wise product)<br>å¦‚: $[10\ 6\ 3\ 7]\odot[0.2\ 0.1\ 0.8\ 0.5]=[2\ 0.6\ 2.4\ 3.5]$                                                                                               |

ä¸€äº›ç»†èŠ‚ï¼š
- ä¸‰ç§é—¨ç»“æ„çš„è¾“å‡º $i_t$ã€$f_t$ å’Œ $o_t$ å€¼åŸŸä¸º $(0,1)$
- æ¯ä¸ªæ—¶åˆ» t åªæœ‰ $ht$ ä½œä¸ºæœ¬æ—¶åˆ»çš„è¾“å‡ºä»¥ç”¨äºåˆ†ç±»ç­‰å¤„ç†
	- å®é™…ä¸Šï¼Œåœ¨æ¯ä¸ªæ—¶åˆ» $t$ ä¸­åªæœ‰å†…éƒ¨è®°å¿†å•å…ƒä¿¡æ¯ $C_t$ å’Œéšå¼ç¼–ç  $h_t$ è¿™ä¸¤ç§ä¿¡æ¯èµ·åˆ°äº†å¯¹åºåˆ—ä¿¡æ¯è¿›è¡Œä¼ é€’çš„ä½œç”¨
- LSTM å¦‚ä½•å…‹æœæ¢¯åº¦æ¶ˆå¤±ï¼Ÿ
	- LSTM é€šè¿‡å¼•å…¥é—¨ç»“æ„ï¼Œåœ¨ä» t åˆ° t+1 è¿‡ç¨‹ä¸­å¼•å…¥åŠ æ³•æ¥è¿›è¡Œä¿¡æ¯æ›´æ–°ï¼Œé¿å…äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜

#### GRU

é—¨æ§å¾ªç¯å•å…ƒï¼ˆgated recurrent unitï¼ŒGRUï¼‰ç¥ç»ç½‘ç»œ

å¯¹ LSTM ä½œäº†ä¸€å®šçš„ç®€åŒ–ï¼šä¸ç”¨è®°å¿†å•å…ƒï¼Œä»…ä½¿ç”¨éšè—çŠ¶æ€æ¥è¿›è¡Œä¿¡æ¯çš„ä¼ é€’
![Pasted image 20250422120852.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422120852.png)



### 3.5 æ³¨æ„åŠ›æœºåˆ¶


> [!tip] 
> å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š[Transformeræ¨¡å‹è¯¦è§£ï¼ˆå›¾è§£æœ€å®Œæ•´ç‰ˆï¼‰ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/338817680)

é¦–å…ˆç”Ÿæˆæ¯ä¸ªå•è¯çš„å†…åµŒå‘é‡ (åŒ…å«äº†å•è¯åœ¨å¥å­ä¸­ä½ç½®ç¼–ç å‘é‡ä¿¡æ¯), è®°ä¸º $w_i (1\leq i\leq 4)$, å¦‚ä¸‹è®¡ç®—æ¯ä¸ªå•è¯ $w_i$ çš„æŸ¥è¯¢å‘é‡ (query)ã€é”®å‘é‡ (key) å’Œå€¼å‘é‡ (value):
- æŸ¥è¯¢å‘é‡ï¼š$q_i=W^q\times w_i$ ï¼›æœç´¢å•è¯
- é”®å‘é‡ï¼š$k_i=W^k\times w_i$ ï¼›è¢«æœç´¢ç‰©å“çš„æè¿°ä¿¡æ¯
- å€¼å‘é‡ï¼š$v_{i}=W^{v}\times w_{i}$ ï¼›è¢«æœç´¢ç‰©å“çš„è¯­ä¹‰å†…å®¹

åé¢å¯ä»¥çœ‹åˆ°ï¼Œå¯¹æ¯ä¸ªå•è¯è€Œè¨€ $w_i, w^q$ã€$w^k$ å’Œ $w^v$ ä¸‰ä¸ªæ˜ å°„çŸ©é˜µéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯è‡ªæ³¨æ„åŠ›æ¨¡å‹éœ€è¦è®­ç»ƒçš„å…¨éƒ¨å‚æ•°

è‡ªæ³¨æ„åŠ›æ¨¡å‹å°±æ˜¯è¦æŒ–æ˜å•è¯ $w_i$ ä¸å…¶ä»–å•è¯åœ¨å¥å­ä¸­å› ä¸ºä¸Šä¸‹æ–‡ (context) å…³è”è€Œå…·æœ‰çš„è‡ªæ³¨æ„åŠ›å–å€¼å¤§å°ã€‚ä»¥å›¾ 5.21 ä¸­å•è¯ $w_3$ ä¸å…¶ä»–å•è¯ä¹‹é—´è‡ªæ³¨æ„åŠ›å–å€¼å¤§å°è®¡ç®—ä¸ºä¾‹ï¼š
1. è®¡ç®— $w_{3}$ æ‰€å¯¹åº”æŸ¥è¯¢å‘é‡ä¸å…¶ä»–å•è¯å¥å‘é‡ä¹‹é—´çš„ç‚¹ç§¯ï¼Œè¯¥ç‚¹ç§¯å¯ä½œä¸ºå•è¯ $w_{3}$ ä¸å…¶ä»–å•è¯ä¹‹é—´çš„å…³è”åº¦ï¼š$\alpha_{3 i}=q_{3}\cdot k_{i}$
2. å¯¹ $\alpha_{3 i}$ ç»“æœé€šè¿‡ softmax å‡½æ•°è¿›è¡Œå½’ä¸€åŒ–æ“ä½œï¼Œå¾—åˆ° $a_{3 i}^{\prime}$
	å¯¹äºç»™å®šâ€œé¡¹åº„èˆå‰‘ã€æ„åœ¨æ²›å…¬â€å¥å­ï¼Œ$a_{3 i}^{\prime}$ è®°å½•äº†â€œæ„åœ¨â€å•è¯ä¸å…¶ä»–å•è¯æ‰€å…·æœ‰çš„é‡è¦ç¨‹åº¦ (å³æ³¨æ„åŠ›)
3. $a_{3 i}^{\prime}$ ä¹˜ä»¥æ¯ä¸ªå•è¯ $w_i$ æ‰€å¯¹åº”çš„å€¼å‘é‡ $v_i$, å³ $a_{3 i}^{\prime}\times v_i.$
4. å¯¹ä¸Šä¸€æ­¥ç»“æœè¿›è¡Œ $\Sigma_ia_{3 i}^{\prime}\times v_i$, è¿™ä¸ªç»“æœä½œä¸ºåœ¨å½“å‰å¥å­è¯­å¢ƒä¸‹å•è¯ $w_{2}$ â€œæ³¨æ„â€åˆ°ä¸å…¶ä»–å•è¯çš„å…³è”ç¨‹åº¦ (self-attention)


![Pasted image 20250422121437.png|475](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250422121437.png)

Multi-Head Attention: æ„é€ ä¸åŒçš„ Self-Attention è¯†åˆ«ä¸åŒçš„ç‰¹å¾

---
## 04 æ·±åº¦ç”Ÿæˆå­¦ä¹ 

> [!warning] è€ƒè¯•ä¸ä½œè¦æ±‚

ç”Ÿæˆæ¨¡å‹éœ€è¦å­¦ä¹ ç›®æ ‡æ•°æ®çš„åˆ†å¸ƒè§„å¾‹ï¼Œä»¥åˆæˆå±äºç›®æ ‡æ•°æ®ç©ºé—´çš„æ–°æ•°æ®ï¼š
![Pasted image 20250530154454.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530154454.png)

ä¸€äº›ç”Ÿæˆæ¨¡å‹ï¼š
- è‡ªç¼–ç å™¨ Autoencoder AE
	AE çš„ Decoder åªèƒ½ä¿è¯å°†ç”± x ç”Ÿæˆçš„ code è¿˜åŸä¸º x
	å¦‚æœæˆ‘ä»¬éšæœºç”Ÿæˆ 1 ä¸ª codeï¼Œç»è¿‡ AE çš„ Decoder åå¾€å¾€ä¸ä¼šå¾—åˆ°æœ‰æ•ˆçš„å›¾åƒ
	![Pasted image 20250530154652.png|300](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530154652.png)
- å˜åˆ†è‡ªç¼–ç å™¨ Variational Autoencoder VAE
	![Pasted image 20250530154719.png|300](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530154719.png)

### ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ  GAN

ç”Ÿæˆå¯¹æŠ—ç½‘ç»œç”±ä¸€ä¸ªç”Ÿæˆå™¨ï¼ˆgeneratorï¼Œç®€ç§° Gï¼‰å’Œä¸€ä¸ªåˆ¤åˆ«å™¨ï¼ˆdiscriminatorï¼Œç®€ç§° Dï¼‰ç»„æˆ

GAN çš„æ ¸å¿ƒæ˜¯é€šè¿‡ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ä¸¤ä¸ªç¥ç»ç½‘ç»œä¹‹é—´çš„ç«äº‰å¯¹æŠ—ï¼Œä¸æ–­æå‡å½¼æ­¤æ°´å¹³ä»¥ä½¿å¾—ç”Ÿæˆå™¨æ‰€ç”Ÿæˆæ•°æ®ï¼ˆäººä¸ºä¼ªé€ æ•°æ®ï¼‰ä¸çœŸå®æ•°æ®ç›¸ä¼¼ï¼Œåˆ¤åˆ«å™¨æ— æ³•åŒºåˆ†çœŸå®æ•°æ®å’Œç”Ÿæˆæ•°æ®

![Pasted image 20250530154747.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530154747.png)

ç›®æ ‡å‡½æ•°ä¸ºï¼š
$$\min_G \max_D V(D, G) = \mathbb{E}_{x \sim p_{data}(x)}[\log D(x)] + \mathbb{E}_{z \sim p_{z}(z)}[\log(1 - D(G(z)))]$$

> [!NOTE] è®­ç»ƒ GAN
> - è¾“å…¥ï¼šç¥ç»ç½‘ç»œ Dã€Gï¼Œå™ªå£°åˆ†å¸ƒ pz (z)ï¼ŒçœŸå®æ•°æ®åˆ†å¸ƒ pdata (x)
> - è¾“å‡ºï¼šç¥ç»ç½‘ç»œå‚æ•°Î¸dã€Î¸g
> ---
> - ç®—æ³•æ­¥éª¤ï¼š
> 	- æ¯è½®è®­ç»ƒå¾ªç¯æ‰§è¡Œï¼š
> 	- è®­ç»ƒ k è½®åˆ¤åˆ«å™¨ï¼š
> 		- ä»å™ªå£°åˆ†å¸ƒ $p_z (z)$ ä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ $\{z^(1), z^(2), z^{(3)}\ldots z^{(m)}\}$
> 		- ä»çœŸå®æ•°æ®åˆ†å¸ƒ $p_{data}(x)$ ä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ $\{x^{(1)}, x^{(2)}, x^{(3)}\ldots x^{(m)}\}$
> 		- æ²¿æ¢¯åº¦ä¸Šå‡æ–¹å‘æ›´æ–°åˆ¤åˆ«å™¨å‚æ•°ï¼š
> 			$\nabla_{\theta_{d}}\frac{1}{\mathrm{m}}\sum_{i=1}^{m}[\log D\bigl (x^{(i)}\bigr)+\log\left (1-D\left (G\bigl (z^{(i)}\bigr)\right)\right)]$
> 	- ä»å™ªå£°åˆ†å¸ƒ $p_z (z)$ ä¸­é‡‡æ · $m$ ä¸ªæ ·æœ¬ $\{Z^{(1)}, Z^{(2)}, Z^{(3)}... Z^{(m)}\}$
> 	- æ²¿æ¢¯åº¦ä¸‹é™æ–¹å‘æ›´æ–°åˆ¤åˆ«å™¨å‚æ•°ï¼š
> 		$$\nabla_{\theta_{g}}\frac{1}{\mathrm{m}}\sum_{i=1}^{m}\log\left (1-D\left (G\big (z^{(i)}\big)\right)\right)$$
> 

GAN å…·æœ‰æ”¶æ•›å›°éš¾ï¼Œä¸”éå¸¸ä¾èµ–äºåˆé€‚çš„äº¤æ›¿è®­ç»ƒè½®æ¬¡é€‰æ‹©ç­‰ä¸è¶³ï¼Œäºæ˜¯å‡ºç°äº† ğŸ‘‡

Wasserstein GAN
- æ¨¡å‹è¾“å‡ºä¸ä½¿ç”¨ä»¥æ¦‚ç‡å€¼å½¢å¼è¾“å‡ºçš„ sigmoid æ¿€æ´»å‡½æ•°ï¼Œè€Œæ˜¯ç›´æ¥æ ¹æ®è¾“å‡ºå€¼å¤§å°è¯„ä»·å…¶æ•ˆæœ
- ç›¸åº”åœ°ï¼Œç›®æ ‡å‡½æ•°ä¸­ä¹Ÿä¸éœ€è¦å†å–å¯¹æ•°ï¼š
	$$\min_G\max_D V (D, G) = \mathbb{E}_{x\sim p_{data}(x)}[D (x)] - \mathbb{E}_{z\sim p_z (z)}[D (G (z))]$$

> [!tip] æ¡ä»¶ç”Ÿæˆç½‘ç»œ
> å¤šäº†ä¸€ä¸ªçº¦æŸæ¡ä»¶ yï¼Œè¾“å…¥åˆ°ç”Ÿæˆç½‘ç»œ G å’Œåˆ¤åˆ«ç½‘ç»œ D ä¸­ï¼š
> ![Pasted image 20250530155245.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530155245.png)


### å¯¹æŠ—æ ·æœ¬æ”»å‡»

åŠ å…¥éšæœºå™ªå£°åï¼Œå°½ç®¡äººçœ¼ä»èƒ½æ˜æ˜¾åœ°è¯†åˆ«å›¾åƒçš„ä¸»ä½“ï¼Œä½†ç¥ç»ç½‘ç»œä¼šå› æ­¤äº§ç”Ÿæ˜æ˜¾çš„åˆ¤æ–­é”™è¯¯ï¼š
![Pasted image 20250607211128.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250607211128.png)

å¯¹æŠ—ç”Ÿæˆè®­ç»ƒå™¨æ¨¡å‹
- è®©ç”Ÿæˆå™¨æ‰®æ¼”æ”»å‡»è€…ï¼šé«˜æ•ˆåœ°ç”Ÿæˆå¸¦æœ‰æ‰°åŠ¨çš„å¯¹æŠ—æ ·æœ¬ï¼Œå¸®åŠ©åˆ†ç±»ç½‘ç»œå­¦åˆ°"æ‰°åŠ¨"
- è®©åˆ¤åˆ«å™¨æ‰®æ¼”åˆ†ç±»å™¨
![Pasted image 20250607211244.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250607211244.png)


---
## 05 æ·±åº¦å­¦ä¹ åº”ç”¨

â€œè¯è¢‹â€ï¼ˆBag of Wordsï¼‰æ¨¡å‹ï¼šä¸€ä¸ªå•è¯æŒ‰ç…§è¯å…¸åºè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªè¯å…¸ç»´æ•°å¤§å°çš„å‘é‡ï¼ˆè¢«ç§°ä¸º one hot vectorï¼‰ï¼Œå‘é‡ä¸­è¯¥å•è¯æ‰€å¯¹åº”ä½ç½®æŒ‰ç…§å…¶åœ¨æ–‡æ¡£ä¸­å‡ºç°ä¸å¦å–å€¼ä¸º 1 æˆ– 0ã€‚1 è¡¨ç¤ºè¯¥å•è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°ã€0 è¡¨ç¤ºæ²¡æœ‰å‡ºç°
- æ— æ³•æœ‰æ•ˆè®¡ç®—å•è¯ä¸å•è¯ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼åº¦

åˆ†å¸ƒå¼å‘é‡è¡¨è¾¾ (distributed vector representation) ğŸ‘‰ åˆ©ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œå¯å°†æ¯ä¸ªå•è¯è¡¨å¾ä¸ºğ‘ç»´å®æ•°å€¼çš„åˆ†å¸ƒå¼å‘é‡

### Word2Vec

å¦‚ä½•è·å¾—å•ä¸ªå•è¯çš„è¯å‘é‡ï¼Ÿ
1. å°†è¯¥å•è¯è¡¨ç¤ºæˆ $V$ ç»´ one-hot å‘é‡ $X$
2. éšè—å±‚ç¥ç»å…ƒå¤§å°ä¸º $N$, æ¯ä¸ªç¥ç»å…ƒè®°ä¸º $h_i (1\leq i\leq N)$
3. å‘é‡ $X$ ä¸­æ¯ä¸ª $x_i (1\leq i\leq$ $V)$ ä¸éšè—å±‚ç¥ç»å…ƒæ˜¯å…¨è¿æ¥ï¼Œè¿æ¥æƒé‡çŸ©é˜µä¸º $W_{V\times N}$
4. è¿™é‡Œ $W_{V\times N}$ å’Œ $W_{N\times V}^{\prime}$ ä¸ºæ¨¡å‹å‚æ•°
5. ä¸€æ—¦è®­ç»ƒå¾—åˆ°äº†ä¸‹å›¾çš„ç¥ç»ç½‘ç»œï¼Œå°±å¯ä»¥å°†è¾“å…¥å±‚ä¸­ $x_k$ ä¸éšè—å±‚è¿æ¥æƒé‡ä¸º $\{w_{k1}, w_{k2},\cdots, w_{kN}\}$ (éšè—å±‚) ä½œä¸ºç¬¬ $k$ ä¸ªå•è¯ $N$ ç»´è¯å‘é‡ (word vector)

![Pasted image 20250607211951.png|450](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250607211951.png)

> [!tip] Word2Vec çš„ä¸¤ç§è®­ç»ƒæ¨¡å¼
> Continuous Bag-of-Words (CBoW)ï¼šæ ¹æ®æŸä¸ªå•è¯æ‰€å¤„çš„ä¸Šä¸‹æ–‡å•è¯æ¥é¢„æµ‹è¯¥å•è¯
> 
> å¯ç”¨ $x_k$ çš„å‰åº $k-1$ ä¸ªå•è¯å’Œåç»­å•è¯ $c-k$ ä¸ªå•è¯ä¸€èµ·æ¥é¢„æµ‹ $x_k$
> - æ¯ä¸ªè¾“å…¥å•è¯ä»ç„¶æ˜¯ $V$ ç»´å‘é‡ï¼ˆå¯ä»¥æ˜¯ one-hot çš„è¡¨è¾¾ï¼‰
> - éšå¼ç¼–ç ä¸ºæ¯ä¸ªè¾“å…¥å•è¯æ‰€å¯¹åº”ç¼–ç çš„å‡å€¼
> 
> ![Pasted image 20250607212711.png|400](/img/user/02%20CS%20Knowledge/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20Artificial%20Intelligence/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250607212711.png)
> 
> Skip-gramï¼šåˆ©ç”¨æŸä¸ªå•è¯æ¥åˆ†åˆ«é¢„æµ‹è¯¥å•è¯çš„ä¸Šä¸‹æ–‡å•è¯
> 
> æ— è®ºæ˜¯ CBOW è¿˜æ˜¯ Skip-Gram æ¨¡å¼ï¼Œéšç€å•è¯ä¸ªæ•°æ•°ç›®å¢åŠ ï¼Œæ¨¡å‹å‚æ•°æ•°ç›®ä¹Ÿè¿…é€Ÿä¸Šå‡
> ğŸ‘‰ åŠ å¿«æ¨¡å‹è®­ç»ƒï¼šå±‚æ¬¡åŒ– Softmaxï¼ˆHierarchical Softmaxï¼‰ä¸è´Ÿé‡‡æ ·ï¼ˆNegative Samplingï¼‰


