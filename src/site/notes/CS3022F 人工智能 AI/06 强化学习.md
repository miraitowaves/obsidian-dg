---
{"dg-publish":true,"permalink":"/CS3022F äººå·¥æ™ºèƒ½ AI/06 å¼ºåŒ–å­¦ä¹ /","dgPassFrontmatter":true,"noteIcon":""}
---


## 01 å¼ºåŒ–å­¦ä¹ å®šä¹‰ï¼šé©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹

åœ¨æ™ºèƒ½ä¸»ä½“ä¸ŽçŽ¯å¢ƒçš„äº¤äº’ä¸­ï¼Œå­¦ä¹ èƒ½æœ€å¤§åŒ–æ”¶ç›Šçš„è¡ŒåŠ¨æ¨¡å¼ï¼š
![Pasted image 20250529201321.png|375](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529201321.png)

### ç¦»æ•£é©¬å°”å¯å¤«è¿‡ç¨‹ Discrete Markov Process

#### åŸºæœ¬æ¦‚å¿µ

éšæœºè¿‡ç¨‹ï¼šæ˜¯ä¸€åˆ—éšæ—¶é—´å˜åŒ–çš„éšæœºå˜é‡;
- å½“æ—¶é—´æ˜¯ç¦»æ•£é‡æ—¶ï¼Œä¸€ä¸ªéšæœºè¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸º $\{X_t\}_{t=0,1,2,\cdotp\cdotp\cdotp}$, å…¶ä¸­æ¯ä¸ª $X_t$ éƒ½æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™è¢«ç§°ä¸ºç¦»æ•£éšæœºè¿‡ç¨‹

é©¬å°”å¯å¤«é“¾ï¼ˆMarkov Chainï¼‰ï¼šæ»¡è¶³é©¬å°”å¯å¤«æ€§ï¼ˆMarkov Propertyï¼‰çš„ç¦»æ•£éšæœºè¿‡ç¨‹ï¼Œä¹Ÿè¢«ç§°ä¸ºç¦»æ•£é©¬å°”ç§‘å¤«è¿‡ç¨‹
- ð’•+ðŸæ—¶åˆ»çŠ¶æ€ä»…ä¸Žð’•æ—¶åˆ»çŠ¶æ€ç›¸å…³
- äºŒé˜¶ï¼šð’• +ðŸæ—¶åˆ»çŠ¶æ€ä¸Žð’•å’Œð’•âˆ’ðŸæ—¶åˆ»çŠ¶æ€ç›¸å…³

é©¬å°”å¯å¤«å¥–åŠ±è¿‡ç¨‹ï¼ˆMarkov Reward Processï¼‰ï¼šå¼•å…¥å¥–åŠ±
- å¥–åŠ±å‡½æ•° $R{:}S\times S\mapsto\mathbb{R}$, å…¶ä¸­ $R(S_t,S_{t+1})$ æè¿°äº†ä»Žç¬¬ $t$ æ­¥çŠ¶æ€è½¬ç§»åˆ°ç¬¬ $t+1$ æ­¥çŠ¶æ€æ‰€èŽ·å¾—å¥–åŠ±
- åœ¨ä¸€ä¸ªåºåˆ—å†³ç­–è¿‡ç¨‹ä¸­ï¼Œä¸åŒçŠ¶æ€ä¹‹é—´çš„è½¬ç§»äº§ç”Ÿäº†ä¸€ç³»åˆ—çš„å¥–åŠ± $(R_1,R_2,\cdotp\cdotp\cdotp)$, å…¶ä¸­ $R_{t+1}$ ä¸º $R(S_t,S_{t+1})$ çš„ç®€ä¾¿è®°æ³•
- ä¸ºäº†æ¯”è¾ƒä¸åŒçš„å¥–åŠ±åºåˆ—ï¼Œå®šä¹‰åé¦ˆ (return), ç”¨æ¥åæ˜ ç´¯åŠ å¥–åŠ±ï¼š
	$$G_t=R_{t+1}+\gamma R_{t+2}+\gamma^2R_{t+3}+\cdots $$
	å…¶ä¸­è¡°é€€ç³»æ•° (decay factor) $\gamma\in[0,1]$


é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMarkov Decision Processï¼‰ï¼šå¼•å…¥åŠ¨ä½œ
- å®šä¹‰æ™ºèƒ½ä¸»ä½“èƒ½å¤Ÿé‡‡å–çš„åŠ¨ä½œé›†åˆä¸º $A$
	å¯ä»¥æ˜¯æ— é™çš„
- ç”±äºŽä¸åŒçš„åŠ¨ä½œå¯¹çŽ¯å¢ƒé€ æˆçš„å½±å“ä¸åŒï¼Œå› æ­¤çŠ¶æ€è½¬ç§»æ¦‚çŽ‡å®šä¹‰ä¸º $Pr(S_{t+1}|S_t,a_t)$ï¼Œå…¶ä¸­ $a_t \in A$ ä¸ºç¬¬ $t$ æ­¥é‡‡å–çš„åŠ¨ä½œ
	å¯ä»¥æ˜¯éšæœºæ¦‚çŽ‡æ€§çš„è½¬ç§»
- å¥–åŠ±å¯èƒ½å—åŠ¨ä½œçš„å½±å“ï¼Œå› æ­¤ä¿®æ”¹å¥–åŠ±å‡½æ•°ä¸º $R(S_t,a_t,S_{t+1})$

#### ä¾‹å­

![Pasted image 20250529204300.png|475](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529204300.png)

ä½¿ç”¨ç¦»æ•£é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹æè¿°æœºå™¨äººç§»åŠ¨é—®é¢˜ï¼š
- éšæœºå˜é‡åºåˆ— $\{S_t\}_{t=0,1,2,\cdots}$: $S_t$ è¡¨ç¤ºæœºå™¨äººç¬¬ $t$ æ­¥æ‰€åœ¨ä½ç½®ï¼ˆå³çŠ¶æ€ï¼‰ï¼Œæ¯ä¸ªéšæœºå˜é‡ $S_t$ çš„å–å€¼èŒƒå›´ä¸º $S=\{s_1,s_2,\cdots,s_9,s_d\}$
- åŠ¨ä½œé›†åˆ: $A=\{\text{ä¸Š},\text{å³}\}$
- çŠ¶æ€è½¬ç§»æ¦‚çŽ‡ $Pr(S_{t+1}|S_t,a_t)$: æ»¡è¶³é©¬å°”å¯å¤«æ€§ï¼Œå…¶ä¸­ $a_t\in A$ã€‚çŠ¶æ€è½¬ç§»
- å¥–åŠ±å‡½æ•°ï¼š$R(S_t,a_t,S_{t+1})$ 
- è¡°é€€ç³»æ•°ï¼š$\gamma\in[0,1]$

ç»¼åˆä»¥ä¸Šä¿¡æ¯ï¼Œå¯é€šè¿‡ $MDP=\{S,A,Pr,R,\gamma\}$ æ¥åˆ»ç”»é©¬å°”ç§‘å¤«å†³ç­–è¿‡ç¨‹
- é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ $MDP=\{S,A,Pr,R,\gamma\}$ æ˜¯åˆ»ç”»å¼ºåŒ–å­¦ä¹ ä¸­çŽ¯å¢ƒçš„æ ‡å‡†å½¢å¼
- é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å¯ç”¨å¦‚ä¸‹åºåˆ—æ¥è¡¨ç¤ºï¼š
![Pasted image 20250529204424.png|350](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529204424.png)
- é©¬å°”ç§‘å¤«è¿‡ç¨‹ä¸­äº§ç”Ÿçš„çŠ¶æ€åºåˆ—ç§°ä¸ºè½¨è¿¹ (trajectory), å¯å¦‚ä¸‹è¡¨ç¤º
	$$(S_0,a_0,R_1,S_1,a_1,R_2,\cdots,S_T)$$
- è½¨è¿¹é•¿åº¦å¯ä»¥æ˜¯æ— é™çš„ï¼Œä¹Ÿå¯ä»¥æœ‰ç»ˆæ­¢çŠ¶æ€ $S_{T}$ã€‚æœ‰ç»ˆæ­¢çŠ¶æ€çš„é—®é¢˜å«åšåˆ†æ®µçš„ (episodic), å¦åˆ™å«åšæŒç»­çš„ (continuing)
	- åˆ†æ®µé—®é¢˜ä¸­ï¼Œä¸€ä¸ªä»Žåˆå§‹çŠ¶æ€åˆ°ç»ˆæ­¢çŠ¶æ€çš„å®Œæ•´è½¨è¿¹ç§°ä¸ºä¸€ä¸ªç‰‡æ®µ (episode)

#### ç­–ç•¥å­¦ä¹ 

æ™ºèƒ½ä¸»ä½“å¦‚ä½•ä¸ŽçŽ¯å¢ƒäº¤äº’è€Œå®Œæˆä»»åŠ¡ï¼Ÿéœ€è¦è¿›è¡Œç­–ç•¥å­¦ä¹ 
- å·²çŸ¥çš„ï¼šS A R $\gamma$ 
- ä¸ä¸€å®šå·²çŸ¥çš„ï¼šPr
- è§‚å¯Ÿåˆ°çš„ï¼š$(S_0,a_0,R_1,S_1,a_1,R_2,...,S_T)$

ç­–ç•¥å‡½æ•°ï¼š
- ç­–ç•¥å‡½æ•° $\pi{:}S\times A\mapsto[0,1]$, å…¶ä¸­ $\pi(\mathfrak{s},a)$ çš„å€¼è¡¨ç¤ºåœ¨çŠ¶æ€ s ä¸‹é‡‡å–åŠ¨ä½œ $a$ çš„æ¦‚çŽ‡
- ç­–ç•¥å‡½æ•°çš„è¾“å‡ºå¯ä»¥æ˜¯ç¡®å®šçš„ï¼Œå³ç»™å®š s æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€ä¸ªåŠ¨ä½œ $a$ ä½¿å¾—æ¦‚çŽ‡ $\pi($ s, $a)$ å–å€¼ä¸º 1ã€‚å¯¹äºŽç¡®å®šçš„ç­–ç•¥ï¼Œè®°ä¸º $a=\pi(s)$

ä¸ºäº†å¯¹ç­–ç•¥å‡½æ•°ðœ‹è¿›è¡Œè¯„ä¼°ï¼Œå®šä¹‰
- ä»·å€¼å‡½æ•° (Value Function) 
	$V{:}S\mapsto\mathbb{R}$, å…¶ä¸­ $V_\pi(s)=\mathbb{E}_\pi[G_t|S_t=s]$
	å³åœ¨ç¬¬ $t$ æ­¥çŠ¶æ€ä¸º s æ—¶ï¼ŒæŒ‰ç…§ç­–ç•¥ $\pi$ è¡ŒåŠ¨åŽåœ¨æœªæ¥æ‰€èŽ·å¾—åé¦ˆå€¼çš„æœŸæœ›
	$$G_{t}=R_{t+1}+\gamma R_{t+2}+\gamma^{2}R_{t+3}+\cdots $$
- åŠ¨ä½œ-ä»·å€¼å‡½æ•° (Action-Value Function) 
	$q{:}S\times A\mapsto\mathbb{R}$, å…¶ä¸­ $q_\pi(s,a)=\mathbb{E}_\pi[G_t|S_t=s,A_t=a]$
	è¡¨ç¤ºåœ¨ç¬¬ $t$ æ­¥çŠ¶æ€ä¸º s æ—¶ï¼ŒæŒ‰ç…§ç­–ç•¥ $\pi$ é‡‡å–åŠ¨ä½œ $a$ åŽï¼Œåœ¨æœªæ¥æ‰€èŽ·å¾—åé¦ˆå€¼çš„æœŸæœ›

è¿™æ ·ï¼Œç­–ç•¥å­¦ä¹ è½¬æ¢ä¸ºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š**å¯»æ‰¾ä¸€ä¸ªæœ€ä¼˜ç­–ç•¥ $\pi^*$, å¯¹ä»»æ„ $s\in S$ ä½¿å¾— $V_\pi^*(s)$ å€¼æœ€å¤§**


> [!tip] ä»·å€¼å‡½æ•°ä¸ŽåŠ¨ä½œ-ä»·å€¼å‡½æ•°çš„å…³ç³»â€”â€”è´å°”æ›¼æ–¹ç¨‹ï¼ˆBellman Equationï¼‰
> $$V_\pi(s)=\sum_{a\in A}\pi(s,a)q_\pi(s,a)$$
> 
> $$q_\pi(s,a)=\sum_{s^{\prime}\in S}Pr(s^{\prime}|s,a)\left[R(s,a,s^{\prime})+\gamma V_\pi(s^{\prime})\right]$$
> 


---
## 02 ç­–ç•¥ä¼˜åŒ–ä¸Žç­–ç•¥è¯„ä¼°

å¼ºåŒ–å­¦ä¹ æ±‚è§£ï¼šåœ¨ç­–ç•¥ä¼˜åŒ–å’Œç­–ç•¥è¯„ä¼°çš„äº¤æ›¿è¿­ä»£ä¸­ä¼˜åŒ–å‚æ•°
![Pasted image 20250529205513.png|475](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529205513.png)

å¼ºåŒ–å­¦ä¹ çš„æ±‚è§£æ–¹æ³•ï¼š
- åŸºäºŽä»·å€¼ (Value-based) çš„æ–¹æ³•
  - å¯¹ä»·å€¼å‡½æ•°è¿›è¡Œå»ºæ¨¡å’Œä¼°è®¡, ä»¥æ­¤ä¸ºä¾æ®åˆ¶è®¢ç­–ç•¥
- åŸºäºŽç­–ç•¥ (Policy-based) çš„æ–¹æ³•
  - å¯¹ç­–ç•¥å‡½æ•°ç›´æŽ¥è¿›è¡Œå»ºæ¨¡å’Œä¼°è®¡, ä¼˜åŒ–ç­–ç•¥å‡½æ•°ä½¿åé¦ˆæœ€å¤§åŒ–
- åŸºäºŽæ¨¡åž‹ (Model-based) çš„æ–¹æ³•
  - å¯¹çŽ¯å¢ƒçš„è¿ä½œæœºåˆ¶å»ºæ¨¡,ç„¶åŽè¿›è¡Œè§„åˆ’ (planning) ç­‰


### åŸºäºŽä»·å€¼ï¼ˆValue-basedï¼‰çš„æ–¹æ³•

#### ç­–ç•¥ä¼˜åŒ–

ç»™å®šå½“å‰ç­–ç•¥ $\pi$ã€ä»·å€¼å‡½æ•° $V_\pi$ å’Œè¡ŒåŠ¨-ä»·å€¼å‡½æ•° $q_\pi$ æ—¶ï¼Œå¯å¦‚ä¸‹æž„é€ æ–°çš„ç­–ç•¥ $\pi^{\prime}$, $\pi^{\prime}$ è¦æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š
$$\pi ^{\prime }( s) = \arccos _aq_\pi ( s, a)(å¯¹äºŽä»»æ„s\in S)$$

> [!example]-
> ![Pasted image 20250529210225.png](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529210225.png)

#### ç­–ç•¥è¯„ä¼°

é€šè¿‡è¿­ä»£è®¡ç®—è´å°”æ›¼æ–¹ç¨‹è¿›è¡Œç­–ç•¥è¯„ä¼°
- åŠ¨æ€è§„åˆ’
- è’™ç‰¹å¡æ´›é‡‡æ ·
- æ—¶åºå·®åˆ†ï¼ˆTemporal Differenceï¼‰

##### åŠ¨æ€è§„åˆ’

> [!NOTE] ç®—æ³•æµç¨‹
> - åˆå§‹åŒ– $V_{\pi}$ å‡½æ•°
> - å¾ªçŽ¯
> 	- æžšä¸¾ $s\in S$
> 	$$\nu_\pi(s) \gets \sum_{a \in A} \pi(s, a) \sum_{s' \in S} Pr(s' | s, a) [R(s, a, s') + \gamma \nu_\pi(s')]$$
> - ç›´åˆ° $V_{\pi}$ æ”¶æ•›


> [!example]-
> ![Pasted image 20250529210850.png|450](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529210850.png)

##### è’™ç‰¹å¡æ´›é‡‡æ ·

> [!NOTE] ç®—æ³•æµç¨‹
> - é€‰æ‹©ä¸åŒçš„èµ·å§‹çŠ¶æ€ï¼ŒæŒ‰ç…§å½“å‰ç­–ç•¥ $\pi$ é‡‡æ ·è‹¥å¹²è½¨è¿¹ï¼Œè®°å®ƒä»¬çš„é›†åˆä¸ºD
> - æžšä¸¾ $s\in S$
> 	- è®¡ç®— $D$ ä¸­ s æ¯æ¬¡å‡ºçŽ°æ—¶å¯¹åº”çš„åé¦ˆ $G_1,G_2,\cdots,G_k$
> 		$$V_{\pi}(s)\leftarrow\frac{1}{k}\sum_{i=1}^{k}G_{i}$$
> 

> [!example]-
> ![Pasted image 20250529211034.png|475](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529211034.png)

##### æ—¶åºå·®åˆ†

> [!NOTE] ç®—æ³•æµç¨‹
> - åˆå§‹åŒ– $V_\mathrm{\pi}$ å‡½æ•°
> - å¾ªçŽ¯
> 	- åˆå§‹åŒ– s ä¸ºåˆå§‹çŠ¶æ€
> 	- å¾ªçŽ¯
> 		- $a\sim\pi(s,\cdot)$
> 		- æ‰§è¡ŒåŠ¨ä½œ $a$, è§‚å¯Ÿå¥–åŠ± $R$ å’Œä¸‹ä¸€ä¸ªçŠ¶æ€ $s^\prime$
> 		- æ›´æ–° $V_{\pi}(s)\leftarrow V_{\pi}(s)+\alpha[R(s,a,s^{\prime})+\gamma V_{\pi}(s^{\prime})-V_{\pi}(s)]$
> 		- $s\leftarrow s^{\prime}$
> 	- ç›´åˆ° s æ˜¯ç»ˆæ­¢çŠ¶æ€
> - ç›´åˆ° $V_\mathrm{\pi}$ æ”¶æ•›

> [!example]-
> ![Pasted image 20250529211552.png|475](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250529211552.png)

### åŸºäºŽç­–ç•¥ï¼ˆPolicy-basedï¼‰çš„æ–¹æ³•

ç­–ç•¥å‡½æ•°çš„å‚æ•°åŒ–å¯ä»¥è¡¨ç¤ºä¸º $\pi_\theta(s,a)$, å…¶ä¸­ $\theta$ ä¸ºä¸€ç»„å‚æ•°ï¼Œå‡½æ•°å–å€¼è¡¨ç¤ºåœ¨çŠ¶æ€ $s$ ä¸‹é€‰æ‹©åŠ¨ä½œ $a$ çš„æ¦‚çŽ‡
- é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œçš„æ¦‚çŽ‡æ˜¯éšç€å‚æ•°çš„æ”¹å˜è€Œå…‰æ»‘å˜åŒ–çš„
- å…‰æ»‘æ€§å¯¹ç®—æ³•æ”¶æ•›æœ‰æ›´å¥½çš„ä¿è¯

æœ€å¤§åŒ–ç›®æ ‡ï¼š$MAXJ(\boldsymbol{\theta}):=V_{\pi_{\boldsymbol{\theta}}}(s_0)$

ç­–ç•¥æ¢¯åº¦å®šç† (Policy Gradient Theorem) :

$$\nabla_{\boldsymbol{\theta}}J(\boldsymbol{\theta})\propto\sum_s\mu_{\pi_{\boldsymbol{\theta}}}(s)\sum_aq_{\pi_{\boldsymbol{\theta}}}(s,a)\nabla_{\boldsymbol{\theta}}\pi_{\boldsymbol{\theta}}(s,a)$$

- å…¶ä¸­ $\mu_{\pi_\theta}($ s) ç§°ä¸ºç­–ç•¥ $\pi_{\boldsymbol{\theta}}$ çš„çŠ¶æ€ s ç­–ç•¥åˆ†å¸ƒï¼Œå‡è®¾ $\gamma=1$ (å³å‰é¢å®šä¹‰çš„æŠ˜æ‰£ç³»æ•°)ã€‚
	- åœ¨æŒç»­é—®é¢˜ä¸­ï¼Œ$\mu_{\pi_\theta}(s)$ ä¸ºç®—æ³•ä»Ž $s_0$ å‡ºå‘ç»è¿‡æ— é™å¤šæ­¥åŽä½äºŽçŠ¶æ€ s çš„æ¦‚çŽ‡
	- åœ¨åˆ†æ®µé—®é¢˜ä¸­ï¼Œ$\mu_{\pi_{\theta}}(s)$ ä¸ºå½’ä¸€åŒ–åŽçš„ç®—æ³•ä»Ž $s_0$ å‡ºå‘è®¿é—® $s$ çš„æ¬¡æ•°çš„æœŸæœ›
	- å½“ $\gamma\in(0,1)$ æ—¶ï¼Œåˆ™éœ€è¦ç»™æ¯ä¸ªçŠ¶æ€çš„ $\mu_{\pi_\theta}$ (s) å€¼åŠ ä¸Šä¸€ä¸ªæƒé‡ã€‚åœ¨ä¿è¯ç®—æ³•é€šç”¨æ€§çš„å‰æä¸‹ï¼Œä¸ºäº†ç®€åŒ–è¯´æ˜Žï¼Œä¸‹æ–‡åœ¨è¿›è¡Œå…¬å¼æŽ¨å¯¼æ—¶å§‹ç»ˆå‡è®¾ $\gamma=1$, ä½†æ˜¯åœ¨ç®—æ³•æµç¨‹ä¸­ä¼šä½“çŽ°æŠ˜æ‰£ç³»æ•° $\gamma$ çš„å½±å“ã€‚
- ç­–ç•¥æ¢¯åº¦æ³•çš„æ±‚è§£æ€è·¯ï¼šå¦‚æžœèƒ½å¤Ÿè®¡ç®—æˆ–ä¼°è®¡å‡ºä¸Šè¿°å…¬å¼ä¸­çš„æ¢¯åº¦ã€æ™ºèƒ½ä½“å°±èƒ½ç›´æŽ¥å¯¹ç­–ç•¥å‡½æ•°è¿›è¡Œä¼˜åŒ–

#TODO 


---
## 03 Q-Learning

> [!NOTE] Q-Learning ç®—æ³•æµç¨‹
> - åˆå§‹åŒ– $q_\mathrm{\pi}$ å‡½æ•°
> - å¾ªçŽ¯
> 	- åˆå§‹åŒ– s ä¸ºåˆå§‹çŠ¶æ€
> 	- å¾ªçŽ¯
> 		- $a=\operatorname{argmax}_{a^{\prime}}q_{\pi}(s,a^{\prime})$
> 		- æ‰§è¡ŒåŠ¨ä½œ $a$, è§‚å¯Ÿå¥–åŠ± $R$ å’Œä¸‹ä¸€ä¸ªçŠ¶æ€ $s^\prime$
> 		- æ›´æ–° $q_{\pi}(s,a)\leftarrow q_{\pi}(s,a)+\alpha\left[R+\gamma\max_{a^{\prime}}q_{\pi}(s^{\prime},a^{\prime})-q_{\pi}(s,a)\right]$
> 		- $s\leftarrow s^{\prime}$
> 	- ç›´åˆ° s æ˜¯ç»ˆæ­¢çŠ¶æ€ç›´åˆ°
> - $q_\pi$ æ”¶æ•›

> [!example]-
> 
> ![Pasted image 20250530134531.png](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530134531.png)
> ![Pasted image 20250530134612.png](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530134612.png)
> ![Pasted image 20250530135029.png](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530135029.png)
> ![Pasted image 20250530135116.png](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530135116.png)
> ![Pasted image 20250530135301.png](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530135301.png)

### æŽ¢ç´¢ï¼ˆexplorationï¼‰ä¸Žåˆ©ç”¨ï¼ˆexploitationï¼‰çš„å¹³è¡¡

![Pasted image 20250530141237.png|450](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530141237.png)

ä¸ºä½• Q å­¦ä¹ æ”¶æ•›åˆ°éžæœ€ä¼˜ç­–ç•¥ï¼Ÿ
- ç®—æ³•ä¸­åªæœ‰åˆ©ç”¨æ²¡æœ‰æŽ¢ç´¢
- (ç‰¹å®šçš„ q åˆå§‹ q å‡½æ•°ï¼Œä¼šè®©ç­–ç•¥æ— æ³•æ”¹å˜å…¶è½¨è¿¹)

å¤§ä½“ä¸Šåˆ©ç”¨ï¼Œå¶å°”æŽ¢ç´¢ðŸ‘‡
$\epsilon$ è´ªå¿ƒï¼ˆ$\epsilon$ -greedyï¼‰ç­–ç•¥ï¼š
$$\epsilon-greedy_{\pi}(s)=\left\{\begin{array}{ll}\operatorname{argmax}_{a} q_{\pi}(s, a), & \text { ä»¥ } 1-\epsilon \text { çš„æ¦‚çŽ‡ } \\ \text { éšæœºçš„ } a \in A, & \text { ä»¥ } \epsilon \text { çš„æ¦‚çŽ‡ }\end{array}\right.$$

> [!NOTE] åŠ ä¸Š $\epsilon$ è´ªå¿ƒï¼ˆ$\epsilon$ -greedyï¼‰ç­–ç•¥åŽçš„ Q-Learning
> - åˆå§‹åŒ–$q_\mathrm{\pi}$å‡½æ•°
> - å¾ªçŽ¯
> 	- åˆå§‹åŒ– s ä¸ºåˆå§‹çŠ¶æ€
> 	- å¾ªçŽ¯
> 		- $a = \epsilon-greedy_{\pi}(s)$
> 		- æ‰§è¡ŒåŠ¨ä½œ$a$, è§‚å¯Ÿå¥–åŠ±$R$å’Œä¸‹ä¸€ä¸ªçŠ¶æ€ $s^\prime$
> 		- æ›´æ–°$q_{\pi}(s, a)\leftarrow q_{\pi}(s, a)+\alpha\left[R+\gamma\max_{a^{\prime}}q_{\pi}(s^{\prime}, a^{\prime})-q_{\pi}(s, a)\right]$
> 		- $s\leftarrow s^{\prime}$
> 	- ç›´åˆ° s æ˜¯ç»ˆæ­¢çŠ¶æ€ç›´åˆ°
> - $q_\pi$æ”¶æ•›

> [!example]-
> ![Pasted image 20250530141250.png|475](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530141250.png)


---
## 04 æ·±åº¦å¼ºåŒ–å­¦ä¹ 

### æ·±åº¦ Q å­¦ä¹ 

- çŠ¶æ€æ•°é‡å¤ªå¤šæ—¶ï¼Œæœ‰äº›çŠ¶æ€å¯èƒ½å§‹ç»ˆæ— æ³•é‡‡æ ·åˆ°
- çŠ¶æ€æ•°é‡æ— é™æ—¶ï¼Œä¸å¯èƒ½ç”¨ä¸€å¼ è¡¨ (æ•°ç»„) æ¥è®°å½•ð‘žå‡½æ•°çš„å€¼
ðŸ‘‰ å°†ð‘žå‡½æ•°å‚æ•°åŒ–ï¼ˆparametrizeï¼‰ï¼Œç”¨ä¸€ä¸ªéžçº¿æ€§å›žå½’æ¨¡åž‹æ¥æ‹Ÿåˆð‘žå‡½æ•°ï¼Œä¾‹å¦‚ (æ·±åº¦) ç¥žç»ç½‘ç»œ

![Pasted image 20250530141516.png|475](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530141516.png)

ä¼ªä»£ç ï¼šæ·±åº¦ Q å­¦ä¹ 
- åˆå§‹åŒ–$q_\mathrm{\pi}$å‡½æ•°çš„å‚æ•°$\theta$
- å¾ªçŽ¯
	- åˆå§‹åŒ– s ä¸ºåˆå§‹çŠ¶æ€
	- å¾ªçŽ¯
		- é‡‡æ ·$a\sim\epsilon-greedy_{\pi}(s;\theta)$
		- æ‰§è¡ŒåŠ¨ä½œ$a$, è§‚å¯Ÿå¥–åŠ±$R$å’Œä¸‹ä¸€ä¸ªçŠ¶æ€ s'
		- æŸå¤±å‡½æ•° L$(\theta)=\frac12\begin{bmatrix}R+\gamma\max_{a^{\prime}}q_{\pi}(s^{\prime}, a^{\prime};\theta)-q_{\pi}(s, a;\theta)\end{bmatrix}^2$
		- æ ¹æ®æ¢¯åº¦$\partial L (\theta)/\partial\theta$æ›´æ–°å‚æ•°$\theta$
		- $s\leftarrow s^{\prime}$
	- ç›´åˆ° s æ˜¯ç»ˆæ­¢çŠ¶æ€
- æŒ‡å¯¼ $q_{\pi}$ æ”¶æ•›

ä¸¤ä¸ªä¸ç¨³å®šå› ç´ ï¼š
- ç›¸é‚»çš„æ ·æœ¬æ¥è‡ªåŒä¸€æ¡è½¨è¿¹ï¼Œæ ·æœ¬ä¹‹é—´ç›¸å…³æ€§å¤ªå¼ºï¼Œé›†ä¸­ä¼˜åŒ–ç›¸å…³æ€§å¼ºçš„æ ·æœ¬å¯èƒ½å¯¼è‡´ç¥žç»ç½‘ç»œåœ¨å…¶ä»–æ ·æœ¬ä¸Šæ•ˆæžœä¸‹é™
- åœ¨æŸå¤±å‡½æ•°ä¸­ï¼Œð‘žå‡½æ•°çš„å€¼æ—¢ç”¨æ¥ä¼°è®¡ç›®æ ‡å€¼ï¼Œåˆç”¨æ¥è®¡ç®—å½“å‰å€¼ã€‚çŽ°åœ¨è¿™ä¸¤å¤„çš„ð‘žå‡½æ•°é€šè¿‡ðœƒæœ‰æ‰€å…³è”ï¼Œå¯èƒ½å¯¼è‡´ä¼˜åŒ–æ—¶ä¸ç¨³å®š

ç»éªŒé‡çŽ° Experience Replay
- å°†è¿‡åŽ»çš„ç»éªŒå­˜å‚¨ä¸‹æ¥ï¼Œæ¯æ¬¡å°†æ–°çš„æ ·æœ¬åŠ å…¥åˆ°å­˜å‚¨ä¸­åŽ»ï¼Œå¹¶ä»Žå­˜å‚¨ä¸­é‡‡æ ·ä¸€æ‰¹æ ·æœ¬è¿›è¡Œä¼˜åŒ– 
- è§£å†³äº†æ ·æœ¬ç›¸å…³æ€§å¼ºçš„é—®é¢˜ 
- é‡ç”¨ç»éªŒï¼Œæé«˜äº†ä¿¡æ¯åˆ©ç”¨çš„æ•ˆçŽ‡
![Pasted image 20250530142116.png|425](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530142116.png)

ç›®æ ‡ç½‘ç»œ Target Network
	$$\frac12[R+\gamma\max_{a^{\prime}}\boxed{q_\pi (s^{\prime}, a^{\prime};\theta^{-})}-q_\pi (s, a;\theta)]^2$$
- æŸå¤±å‡½æ•°çš„ä¸¤ä¸ªð‘žå‡½æ•°ä½¿ç”¨ä¸åŒçš„å‚æ•°è®¡ç®—
- ç”¨äºŽè®¡ç®—ä¼°è®¡å€¼çš„$q$ä½¿ç”¨å‚æ•°$\theta^-$è®¡ç®—ï¼Œè¿™ä¸ªç½‘ç»œå«åšç›®æ ‡ç½‘ç»œ
- ç”¨äºŽè®¡ç®—å½“å‰å€¼çš„$q$ä½¿ç”¨å‚æ•°$\theta$è®¡ç®—
- ä¿æŒ$\theta^-$çš„å€¼ç›¸å¯¹ç¨³å®šï¼Œä¾‹å¦‚$\theta$æ¯æ›´æ–°å¤šæ¬¡åŽæ‰åŒæ­¥ä¸¤è€…çš„å€¼
$$\theta^{-}\leftarrow\theta $$

![Pasted image 20250530142322.png|450](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530142322.png)


### Tips of Q-Learning

> [!tip] ä¸€äº›ç§‘ç ”çš„ç»éªŒåˆ†äº«


---
## 05 å¤šæ™ºèƒ½ä½“å¼ºåŒ–å­¦ä¹ 

![Pasted image 20250530143756.png|500](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530143756.png)

ä¸¤ä¸ªé—®é¢˜ï¼š
- å¤šæ™ºèƒ½ä½“ä¿¡ç”¨åˆ†é…é—®é¢˜ (Credit Assignment)
	- å½“åªå­˜åœ¨ Global reward æ—¶ï¼Œå¦‚ä½•ä¸ºæ¯ä¸ªæ™ºèƒ½ä½“åˆ†é… Reward or Value function
- å¤šæ™ºèƒ½ä½“é€šä¿¡å­¦ä¹ é—®é¢˜ (Communication Learning)
	- æ¯ä¸ªæ™ºèƒ½ä½“å¦‚ä½•ä¸Žå…¶ä»–æ™ºèƒ½ä½“è¿›è¡Œé«˜æ•ˆçš„äº¤æµ

> [!tip] æ²™æ™®åˆ©å€¼
> 
> ![Pasted image 20250530144043.png|450](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530144043.png)
> ![Pasted image 20250530144058.png|450](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530144058.png)
> ![Pasted image 20250530144112.png|450](/img/user/CS3022F%20%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%20AI/public/Pasted%20image%2020250530144112.png)

